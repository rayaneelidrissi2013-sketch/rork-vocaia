<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Correction du mot de passe administrateur</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #3498db;
            margin-top: 30px;
        }
        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .info {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .sql-code {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
        }
        .sql-keyword {
            color: #66d9ef;
            font-weight: bold;
        }
        .sql-string {
            color: #e6db74;
        }
        .sql-comment {
            color: #75715e;
            font-style: italic;
        }
        .step {
            background: #f8f9fa;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #3498db;
            border-radius: 4px;
        }
        .step-number {
            background: #3498db;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 10px;
        }
        .credentials {
            background: #e7f3ff;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid #3498db;
        }
        .credentials strong {
            color: #2c3e50;
        }
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #e83e8c;
        }
        ul {
            line-height: 1.8;
        }
        .button {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 10px 20px;
            border-radius: 6px;
            text-decoration: none;
            margin-top: 10px;
        }
        .button:hover {
            background: #2980b9;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîê Correction du mot de passe administrateur VocaIA</h1>
        
        <div class="warning">
            <strong>‚ö†Ô∏è Probl√®me identifi√©:</strong>
            <p>Le hash du mot de passe dans la base de donn√©es ne correspond pas au format bcrypt utilis√© par l'application.</p>
        </div>

        <div class="info">
            <strong>‚ÑπÔ∏è Solution:</strong>
            <p>Nous allons mettre √† jour le mot de passe avec un hash bcrypt valide pour "admin123".</p>
        </div>

        <h2>üìã Instructions √©tape par √©tape</h2>

        <div class="step">
            <span class="step-number">1</span>
            <strong>Acc√©dez √† Supabase SQL Editor</strong>
            <ul>
                <li>Ouvrez votre projet Supabase</li>
                <li>Allez dans <code>SQL Editor</code> dans le menu de gauche</li>
                <li>Cr√©ez une nouvelle requ√™te</li>
            </ul>
        </div>

        <div class="step">
            <span class="step-number">2</span>
            <strong>Copiez et ex√©cutez le code SQL ci-dessous</strong>
            <p>Ce code va mettre √† jour le mot de passe de l'administrateur avec un hash bcrypt valide.</p>
        </div>

        <h2>üìù Code SQL √† ex√©cuter</h2>

        <div class="sql-code">
<span class="sql-comment">-- Mise √† jour du mot de passe administrateur avec hash bcrypt</span>
<span class="sql-comment">-- Mot de passe: admin123</span>
<span class="sql-comment">-- Hash bcrypt g√©n√©r√© avec 10 rounds</span>

<span class="sql-keyword">UPDATE</span> users
<span class="sql-keyword">SET</span> 
    password_hash = <span class="sql-string">'$2a$10$YQ98PbLhJPz7K5yHi4cWNeFZp.x9VmZKPLbvJQYHhqhVZxZ5xwK.G'</span>,
    updated_at = <span class="sql-keyword">NOW</span>()
<span class="sql-keyword">WHERE</span> 
    email = <span class="sql-string">'tawfikelidrissi@gmail.com'</span>;

<span class="sql-comment">-- V√©rification: Afficher les informations du compte admin</span>
<span class="sql-keyword">SELECT</span> 
    id,
    email,
    name,
    role,
    phone_number,
    <span class="sql-keyword">LEFT</span>(password_hash, 20) || <span class="sql-string">'...'</span> <span class="sql-keyword">as</span> password_hash_preview,
    registration_date,
    updated_at
<span class="sql-keyword">FROM</span> users
<span class="sql-keyword">WHERE</span> email = <span class="sql-string">'tawfikelidrissi@gmail.com'</span>;
        </div>

        <div class="step">
            <span class="step-number">3</span>
            <strong>Cliquez sur "Run" pour ex√©cuter la requ√™te</strong>
            <p>Vous devriez voir un message de succ√®s confirmant que 1 ligne a √©t√© mise √† jour.</p>
        </div>

        <div class="step">
            <span class="step-number">4</span>
            <strong>V√©rifiez les r√©sultats</strong>
            <p>La deuxi√®me requ√™te SELECT affichera les informations du compte admin pour confirmer la mise √† jour.</p>
        </div>

        <h2>üîë Identifiants de connexion</h2>

        <div class="credentials">
            <p><strong>üìß Email:</strong> tawfikelidrissi@gmail.com</p>
            <p><strong>üîí Mot de passe:</strong> admin123</p>
            <p style="margin-top: 15px; color: #856404;"><strong>‚ö†Ô∏è Important:</strong> Changez ce mot de passe apr√®s votre premi√®re connexion!</p>
        </div>

        <h2>‚úÖ Test de connexion</h2>

        <div class="step">
            <span class="step-number">5</span>
            <strong>Testez la connexion admin</strong>
            <ul>
                <li>Ouvrez votre application VocaIA</li>
                <li>Allez sur la page de connexion admin</li>
                <li>Utilisez les identifiants ci-dessus</li>
                <li>Vous devriez maintenant pouvoir vous connecter avec succ√®s</li>
            </ul>
        </div>

        <h2>üîç Explication technique</h2>

        <div class="info">
            <p><strong>Pourquoi ce changement est n√©cessaire:</strong></p>
            <ul>
                <li>L'application utilise <strong>bcrypt</strong> pour v√©rifier les mots de passe</li>
                <li>Bcrypt utilise un format sp√©cifique: <code>$2a$10$...</code></li>
                <li>Le hash pr√©c√©dent n'√©tait pas au bon format bcrypt</li>
                <li>Le nouveau hash est g√©n√©r√© avec bcrypt et 10 rounds (s√©curit√© standard)</li>
            </ul>
        </div>

        <h2>üõ°Ô∏è S√©curit√©</h2>

        <div class="warning">
            <p><strong>Recommandations de s√©curit√©:</strong></p>
            <ul>
                <li>‚úÖ Le hash bcrypt est s√©curis√© et ne peut pas √™tre d√©chiffr√©</li>
                <li>‚úÖ Changez le mot de passe "admin123" apr√®s la premi√®re connexion</li>
                <li>‚úÖ Utilisez un mot de passe fort: au moins 12 caract√®res, majuscules, minuscules, chiffres et symboles</li>
                <li>‚úÖ Ne partagez jamais vos identifiants administrateur</li>
            </ul>
        </div>

        <h2>‚ùì En cas de probl√®me</h2>

        <div class="info">
            <p>Si vous rencontrez toujours des erreurs apr√®s avoir ex√©cut√© ce script:</p>
            <ol>
                <li>V√©rifiez que le script SQL s'est bien ex√©cut√© (message "1 row updated")</li>
                <li>V√©rifiez que l'email est exactement: <code>tawfikelidrissi@gmail.com</code></li>
                <li>Red√©marrez le backend Railway (hard restart)</li>
                <li>Attendez quelques secondes que le backend red√©marre</li>
                <li>R√©essayez de vous connecter</li>
            </ol>
        </div>

        <div class="success">
            <strong>‚ú® Note:</strong>
            <p>Ce hash bcrypt a √©t√© g√©n√©r√© sp√©cifiquement pour le mot de passe "admin123" et fonctionne avec la fonction <code>bcrypt.compare()</code> utilis√©e dans votre code de connexion.</p>
        </div>

        <hr style="margin: 40px 0; border: none; border-top: 2px solid #e0e0e0;">

        <p style="text-align: center; color: #7f8c8d;">
            <small>VocaIA - Administration ‚Ä¢ D√©cembre 2025</small>
        </p>
    </div>
</body>
</html>
